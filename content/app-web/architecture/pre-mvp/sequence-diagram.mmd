sequenceDiagram
  participant User
  participant FE as Frontend (Next.js)
  participant API as Supabase API
  participant DB as Supabase DB
  participant PH as PostHog
  participant Email as Email Service

  User->>FE: start quiz
  FE->>API: GET /quiz (questions)
  API->>DB: fetch quiz structure
  DB-->>API: quiz JSON
  API-->>FE: return quiz JSON

  User->>FE: submits answers
  FE->>API: POST /quiz (answers)
  API->>DB: insert QuizResponses
  API->>PH: track event "quiz_completed"

  alt user leaves email
    FE->>API: POST /lead (email)
    API->>DB: insert Leads
    API->>Email: add to mailing list
  end

  API-->>FE: confirmation + outro
  FE-->>User: show outro + CTA
