<mxfile host="app.diagrams.net" agent="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36 Edg/139.0.0.0" version="28.1.1">
  <diagram name="Page-1" id="RQwGvB-Z3ULJwTiBkC4l">
    <mxGraphModel dx="2954" dy="1903" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="850" pageHeight="1100" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="NJfkyr94-Tqlk53_Z8Gw-1" value="Supabase Edge Middleware" style="whiteSpace=wrap;strokeWidth=2;verticalAlign=top;" vertex="1" parent="1">
          <mxGeometry x="419" y="170" width="1510" height="1731" as="geometry" />
        </mxCell>
        <mxCell id="NJfkyr94-Tqlk53_Z8Gw-2" value="Incoming request" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="NJfkyr94-Tqlk53_Z8Gw-1">
          <mxGeometry x="474" y="46" width="183" height="54" as="geometry" />
        </mxCell>
        <mxCell id="NJfkyr94-Tqlk53_Z8Gw-3" value="OPTIONS preflight?" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="NJfkyr94-Tqlk53_Z8Gw-1">
          <mxGeometry x="468" y="175" width="195" height="54" as="geometry" />
        </mxCell>
        <mxCell id="NJfkyr94-Tqlk53_Z8Gw-4" value="204 preflight OK&#xa;with CORS headers" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="NJfkyr94-Tqlk53_Z8Gw-1">
          <mxGeometry x="43" y="1495" width="260" height="78" as="geometry" />
        </mxCell>
        <mxCell id="NJfkyr94-Tqlk53_Z8Gw-5" value="Return response" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="NJfkyr94-Tqlk53_Z8Gw-1">
          <mxGeometry x="502" y="1648" width="175" height="54" as="geometry" />
        </mxCell>
        <mxCell id="NJfkyr94-Tqlk53_Z8Gw-6" value="Origin in ALLOW_ORIGINS?" style="rhombus;strokeWidth=2;whiteSpace=wrap;" vertex="1" parent="NJfkyr94-Tqlk53_Z8Gw-1">
          <mxGeometry x="523" y="326" width="241" height="241" as="geometry" />
        </mxCell>
        <mxCell id="NJfkyr94-Tqlk53_Z8Gw-7" value="403 CORS blocked" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="NJfkyr94-Tqlk53_Z8Gw-1">
          <mxGeometry x="221" y="724" width="188" height="54" as="geometry" />
        </mxCell>
        <mxCell id="NJfkyr94-Tqlk53_Z8Gw-8" value="Method allowed?" style="rhombus;strokeWidth=2;whiteSpace=wrap;" vertex="1" parent="NJfkyr94-Tqlk53_Z8Gw-1">
          <mxGeometry x="672" y="664" width="173" height="173" as="geometry" />
        </mxCell>
        <mxCell id="NJfkyr94-Tqlk53_Z8Gw-9" value="405 method not allowed" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="NJfkyr94-Tqlk53_Z8Gw-1">
          <mxGeometry x="332" y="951" width="234" height="54" as="geometry" />
        </mxCell>
        <mxCell id="NJfkyr94-Tqlk53_Z8Gw-10" value="Path" style="rhombus;strokeWidth=2;whiteSpace=wrap;" vertex="1" parent="NJfkyr94-Tqlk53_Z8Gw-1">
          <mxGeometry x="821" y="935" width="86" height="86" as="geometry" />
        </mxCell>
        <mxCell id="NJfkyr94-Tqlk53_Z8Gw-11" value="/quiz GET&#xa;rate: 60 req/min per IP" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="NJfkyr94-Tqlk53_Z8Gw-1">
          <mxGeometry x="244" y="1130" width="260" height="78" as="geometry" />
        </mxCell>
        <mxCell id="NJfkyr94-Tqlk53_Z8Gw-12" value="/quiz POST&#xa;rate: 30 req/min per IP&#xa;+ 10 req/min per session_id" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="NJfkyr94-Tqlk53_Z8Gw-1">
          <mxGeometry x="578" y="1118" width="260" height="102" as="geometry" />
        </mxCell>
        <mxCell id="NJfkyr94-Tqlk53_Z8Gw-13" value="/lead POST&#xa;rate: 10 req/min per IP&#xa;+ 3 req/min per email_hash" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="NJfkyr94-Tqlk53_Z8Gw-1">
          <mxGeometry x="913" y="1118" width="260" height="102" as="geometry" />
        </mxCell>
        <mxCell id="NJfkyr94-Tqlk53_Z8Gw-14" value="default&#xa;rate: 20 req/min per IP" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="NJfkyr94-Tqlk53_Z8Gw-1">
          <mxGeometry x="1223" y="1130" width="260" height="78" as="geometry" />
        </mxCell>
        <mxCell id="NJfkyr94-Tqlk53_Z8Gw-15" value="429 too many requests" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="NJfkyr94-Tqlk53_Z8Gw-1">
          <mxGeometry x="760" y="1342" width="222" height="54" as="geometry" />
        </mxCell>
        <mxCell id="NJfkyr94-Tqlk53_Z8Gw-16" value="Call Edge Function&#xa;(GET /quiz | POST /quiz | POST /lead)" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="NJfkyr94-Tqlk53_Z8Gw-1">
          <mxGeometry x="1032" y="1318" width="260" height="102" as="geometry" />
        </mxCell>
        <mxCell id="NJfkyr94-Tqlk53_Z8Gw-17" value="Add CORS headers on response" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="NJfkyr94-Tqlk53_Z8Gw-1">
          <mxGeometry x="1032" y="1495" width="260" height="78" as="geometry" />
        </mxCell>
        <mxCell id="NJfkyr94-Tqlk53_Z8Gw-18" value="" style="curved=1;startArrow=none;endArrow=block;exitX=0.5;exitY=0.99;entryX=0.5;entryY=-0.01;rounded=0;" edge="1" parent="NJfkyr94-Tqlk53_Z8Gw-1" source="NJfkyr94-Tqlk53_Z8Gw-2" target="NJfkyr94-Tqlk53_Z8Gw-3">
          <mxGeometry relative="1" as="geometry">
            <Array as="points" />
          </mxGeometry>
        </mxCell>
        <mxCell id="NJfkyr94-Tqlk53_Z8Gw-19" value="yes" style="curved=1;startArrow=none;endArrow=block;exitX=0;exitY=0.84;entryX=0.5;entryY=-0.01;rounded=0;" edge="1" parent="NJfkyr94-Tqlk53_Z8Gw-1" source="NJfkyr94-Tqlk53_Z8Gw-3" target="NJfkyr94-Tqlk53_Z8Gw-4">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="173" y="277" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="NJfkyr94-Tqlk53_Z8Gw-20" value="" style="curved=1;startArrow=none;endArrow=block;exitX=0.5;exitY=0.99;entryX=0;entryY=0.24;rounded=0;" edge="1" parent="NJfkyr94-Tqlk53_Z8Gw-1" source="NJfkyr94-Tqlk53_Z8Gw-4" target="NJfkyr94-Tqlk53_Z8Gw-5">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="173" y="1610" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="NJfkyr94-Tqlk53_Z8Gw-21" value="no" style="curved=1;startArrow=none;endArrow=block;exitX=0.64;exitY=0.99;entryX=0.5;entryY=0;rounded=0;" edge="1" parent="NJfkyr94-Tqlk53_Z8Gw-1" source="NJfkyr94-Tqlk53_Z8Gw-3" target="NJfkyr94-Tqlk53_Z8Gw-6">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="643" y="277" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="NJfkyr94-Tqlk53_Z8Gw-22" value="no" style="curved=1;startArrow=none;endArrow=block;exitX=0;exitY=0.76;entryX=0.5;entryY=0;rounded=0;" edge="1" parent="NJfkyr94-Tqlk53_Z8Gw-1" source="NJfkyr94-Tqlk53_Z8Gw-6" target="NJfkyr94-Tqlk53_Z8Gw-7">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="315" y="616" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="NJfkyr94-Tqlk53_Z8Gw-23" value="yes" style="curved=1;startArrow=none;endArrow=block;exitX=0.84;exitY=1;entryX=0.5;entryY=0;rounded=0;" edge="1" parent="NJfkyr94-Tqlk53_Z8Gw-1" source="NJfkyr94-Tqlk53_Z8Gw-6" target="NJfkyr94-Tqlk53_Z8Gw-8">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="759" y="616" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="NJfkyr94-Tqlk53_Z8Gw-24" value="no" style="curved=1;startArrow=none;endArrow=block;exitX=0;exitY=0.72;entryX=0.5;entryY=0;rounded=0;" edge="1" parent="NJfkyr94-Tqlk53_Z8Gw-1" source="NJfkyr94-Tqlk53_Z8Gw-8" target="NJfkyr94-Tqlk53_Z8Gw-9">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="449" y="886" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="NJfkyr94-Tqlk53_Z8Gw-25" value="yes" style="curved=1;startArrow=none;endArrow=block;exitX=0.89;exitY=1;entryX=0.49;entryY=0;rounded=0;" edge="1" parent="NJfkyr94-Tqlk53_Z8Gw-1" source="NJfkyr94-Tqlk53_Z8Gw-8" target="NJfkyr94-Tqlk53_Z8Gw-10">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="863" y="886" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="NJfkyr94-Tqlk53_Z8Gw-26" value="/quiz GET" style="curved=1;startArrow=none;endArrow=block;exitX=0;exitY=0.59;entryX=0.5;entryY=0;rounded=0;" edge="1" parent="NJfkyr94-Tqlk53_Z8Gw-1" source="NJfkyr94-Tqlk53_Z8Gw-10" target="NJfkyr94-Tqlk53_Z8Gw-11">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="374" y="1069" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="NJfkyr94-Tqlk53_Z8Gw-27" value="/quiz POST" style="curved=1;startArrow=none;endArrow=block;exitX=0;exitY=0.79;entryX=0.5;entryY=0;rounded=0;" edge="1" parent="NJfkyr94-Tqlk53_Z8Gw-1" source="NJfkyr94-Tqlk53_Z8Gw-10" target="NJfkyr94-Tqlk53_Z8Gw-12">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="708" y="1069" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="NJfkyr94-Tqlk53_Z8Gw-28" value="/lead POST" style="curved=1;startArrow=none;endArrow=block;exitX=0.99;exitY=0.75;entryX=0.5;entryY=0;rounded=0;" edge="1" parent="NJfkyr94-Tqlk53_Z8Gw-1" source="NJfkyr94-Tqlk53_Z8Gw-10" target="NJfkyr94-Tqlk53_Z8Gw-13">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1043" y="1069" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="NJfkyr94-Tqlk53_Z8Gw-29" value="other" style="curved=1;startArrow=none;endArrow=block;exitX=0.99;exitY=0.59;entryX=0.5;entryY=0;rounded=0;" edge="1" parent="NJfkyr94-Tqlk53_Z8Gw-1" source="NJfkyr94-Tqlk53_Z8Gw-10" target="NJfkyr94-Tqlk53_Z8Gw-14">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1353" y="1069" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="NJfkyr94-Tqlk53_Z8Gw-30" value="over limit" style="curved=1;startArrow=none;endArrow=block;exitX=0.42;exitY=1;entryX=0;entryY=0.12;rounded=0;" edge="1" parent="NJfkyr94-Tqlk53_Z8Gw-1" source="NJfkyr94-Tqlk53_Z8Gw-11" target="NJfkyr94-Tqlk53_Z8Gw-15">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="320" y="1269" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="NJfkyr94-Tqlk53_Z8Gw-31" value="over limit" style="curved=1;startArrow=none;endArrow=block;exitX=0.26;exitY=1;entryX=0.15;entryY=-0.01;rounded=0;" edge="1" parent="NJfkyr94-Tqlk53_Z8Gw-1" source="NJfkyr94-Tqlk53_Z8Gw-12" target="NJfkyr94-Tqlk53_Z8Gw-15">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="587" y="1269" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="NJfkyr94-Tqlk53_Z8Gw-32" value="over limit" style="curved=1;startArrow=none;endArrow=block;exitX=0.21;exitY=1;entryX=0.53;entryY=-0.01;rounded=0;" edge="1" parent="NJfkyr94-Tqlk53_Z8Gw-1" source="NJfkyr94-Tqlk53_Z8Gw-13" target="NJfkyr94-Tqlk53_Z8Gw-15">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="897" y="1269" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="NJfkyr94-Tqlk53_Z8Gw-33" value="over limit" style="curved=1;startArrow=none;endArrow=block;exitX=0.32;exitY=1;entryX=0.94;entryY=-0.01;rounded=0;" edge="1" parent="NJfkyr94-Tqlk53_Z8Gw-1" source="NJfkyr94-Tqlk53_Z8Gw-14" target="NJfkyr94-Tqlk53_Z8Gw-15">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1232" y="1269" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="NJfkyr94-Tqlk53_Z8Gw-34" value="ok" style="curved=1;startArrow=none;endArrow=block;exitX=0.72;exitY=1;entryX=0;entryY=0.3;rounded=0;" edge="1" parent="NJfkyr94-Tqlk53_Z8Gw-1" source="NJfkyr94-Tqlk53_Z8Gw-11" target="NJfkyr94-Tqlk53_Z8Gw-16">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="520" y="1269" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="NJfkyr94-Tqlk53_Z8Gw-35" value="ok" style="curved=1;startArrow=none;endArrow=block;exitX=0.74;exitY=1;entryX=0;entryY=0.11;rounded=0;" edge="1" parent="NJfkyr94-Tqlk53_Z8Gw-1" source="NJfkyr94-Tqlk53_Z8Gw-12" target="NJfkyr94-Tqlk53_Z8Gw-16">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="830" y="1269" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="NJfkyr94-Tqlk53_Z8Gw-36" value="ok" style="curved=1;startArrow=none;endArrow=block;exitX=0.74;exitY=1;entryX=0.5;entryY=0;rounded=0;" edge="1" parent="NJfkyr94-Tqlk53_Z8Gw-1" source="NJfkyr94-Tqlk53_Z8Gw-13" target="NJfkyr94-Tqlk53_Z8Gw-16">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1164" y="1269" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="NJfkyr94-Tqlk53_Z8Gw-37" value="ok" style="curved=1;startArrow=none;endArrow=block;exitX=0.6;exitY=1;entryX=1;entryY=0;rounded=0;" edge="1" parent="NJfkyr94-Tqlk53_Z8Gw-1" source="NJfkyr94-Tqlk53_Z8Gw-14" target="NJfkyr94-Tqlk53_Z8Gw-16">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1420" y="1269" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="NJfkyr94-Tqlk53_Z8Gw-38" value="" style="curved=1;startArrow=none;endArrow=block;exitX=0.5;exitY=1;entryX=0.5;entryY=-0.01;rounded=0;" edge="1" parent="NJfkyr94-Tqlk53_Z8Gw-1" source="NJfkyr94-Tqlk53_Z8Gw-16" target="NJfkyr94-Tqlk53_Z8Gw-17">
          <mxGeometry relative="1" as="geometry">
            <Array as="points" />
          </mxGeometry>
        </mxCell>
        <mxCell id="NJfkyr94-Tqlk53_Z8Gw-39" value="" style="curved=1;startArrow=none;endArrow=block;exitX=0.5;exitY=0.99;entryX=1;entryY=0.31;rounded=0;" edge="1" parent="NJfkyr94-Tqlk53_Z8Gw-1" source="NJfkyr94-Tqlk53_Z8Gw-17" target="NJfkyr94-Tqlk53_Z8Gw-5">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1162" y="1610" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="NJfkyr94-Tqlk53_Z8Gw-40" value="Config" style="whiteSpace=wrap;strokeWidth=2;verticalAlign=top;" vertex="1" parent="1">
          <mxGeometry x="1979" y="947" width="1852" height="177" as="geometry" />
        </mxCell>
        <mxCell id="NJfkyr94-Tqlk53_Z8Gw-41" value="ALLOW_ORIGINS:&#xa;https://app.lumlyn.com&#xa;https://lumlyn.com&#xa;http://localhost:3000" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="NJfkyr94-Tqlk53_Z8Gw-40">
          <mxGeometry x="43" y="58" width="292" height="78" as="geometry" />
        </mxCell>
        <mxCell id="NJfkyr94-Tqlk53_Z8Gw-42" value="ALLOW_METHODS: GET, POST, OPTIONS" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="NJfkyr94-Tqlk53_Z8Gw-40">
          <mxGeometry x="385" y="58" width="260" height="78" as="geometry" />
        </mxCell>
        <mxCell id="NJfkyr94-Tqlk53_Z8Gw-43" value="ALLOW_HEADERS: content-type, authorization, x-request-id" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="NJfkyr94-Tqlk53_Z8Gw-40">
          <mxGeometry x="695" y="46" width="260" height="102" as="geometry" />
        </mxCell>
        <mxCell id="NJfkyr94-Tqlk53_Z8Gw-44" value="EXPOSE_HEADERS: x-request-id" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="NJfkyr94-Tqlk53_Z8Gw-40">
          <mxGeometry x="1005" y="58" width="260" height="78" as="geometry" />
        </mxCell>
        <mxCell id="NJfkyr94-Tqlk53_Z8Gw-45" value="ACCESS-CONTROL-MAX-AGE: 600" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="NJfkyr94-Tqlk53_Z8Gw-40">
          <mxGeometry x="1315" y="58" width="260" height="78" as="geometry" />
        </mxCell>
        <mxCell id="NJfkyr94-Tqlk53_Z8Gw-46" value="CREDENTIALS: false" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="NJfkyr94-Tqlk53_Z8Gw-40">
          <mxGeometry x="1625" y="70" width="200" height="54" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
