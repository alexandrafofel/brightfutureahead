flowchart TD
  A["GET /quiz"] --> B["read REMOTE_CONFIG (flags, version)"]
  B --> C["load QUESTIONS (by version)"]
  C --> D["load COPY_TEXT (by version/variant)"]
  B --> E["flags_subset = {..., quiz_copy_variant, version}"]
  D --> F["payload = { questions, copy, flags_subset, quiz_version=version }"]
  F --> G["INSERT CONFIG_SNAPSHOTS(version, flags_json, session_id?)"]
  G --> H["return 200 JSON(payload)"]
  G -. on fail: log + continue .- H
